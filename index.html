<html>

<head>
    <title>You Know You Want Croissant</title>
    <meta name="robots" content="noindex">
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <style>
        body {
            font-family: 'Lucida Grand', Helvetica, Arial, sans-serif;
        }

        #sayings {
            height:0px;
        }

        html { 
          background: url(images/bg.jpg) no-repeat center center fixed; 
          -webkit-background-size: cover;
          -moz-background-size: cover;
          -o-background-size: cover;
          background-size: cover;
        }

    </style>
    <script type="text/javascript">
        var host = location.origin.replace(/^http/, 'ws');
        var socket = io(host);

        socket.on('speak', function (text) {
            var url = "http://translate.google.com/translate_tts?ie=UTF-8&tl=en&q="+encodeURIComponent(text);
            var audio = new Audio(url);
            audio.controls = true;
            var chargeLi = $('<li class="any-player"></li>');
            chargeLi.html(audio.outerHTML);
            $('#sayings').prepend(chargeLi);
            $(".any-player audio")[0].play();
            chargeLi = $('<li class="play-anything"></li>');
            $(chargeLi).text("Spoke: "+text);
            $('#sayings').prepend(chargeLi);
            setInterval(change_image, 250);

            console.log(""+text);
        });

        socket.on('speakFrench', function (text) {
            var url = "http://translate.google.com/translate_tts?ie=UTF-8&tl=fr&q="+encodeURIComponent(text);
            var audio = new Audio(url);
            audio.controls = true;
            var chargeLi = $('<li class="any-player"></li>');
            chargeLi.html(audio.outerHTML);
            $('#sayings').prepend(chargeLi);
            $(".any-player audio")[0].play();
            chargeLi = $('<li class="play-anything"></li>');
            $(chargeLi).text("Spoke: "+text);
            $('#sayings').prepend(chargeLi);
            setInterval(change_image, 250);

            console.log(""+text);
        });

        var sayings = ["What what in the butt?", "Making money", "Saying things you know it.", "Let's try this out."];

        socket.on('randomFrench', function () {
            var text = sayings[Math.floor(Math.random()*sayings.length)];
            var url = "http://translate.google.com/translate_tts?ie=UTF-8&tl=fr&q="+encodeURIComponent(text);
            var audio = new Audio(url);
            audio.controls = true;
            var chargeLi = $('<li class="any-player"></li>');
            chargeLi.html(audio.outerHTML);
            $('#sayings').prepend(chargeLi);
            $(".any-player audio")[0].play();
            chargeLi = $('<li class="play-anything"></li>');
            $(chargeLi).text(""+text);
            $('#sayings').prepend(chargeLi);
            setInterval(change_image, 250);

            console.log("Said "+text);
        }); 

        socket.on('random', function () {
            var text = sayings[Math.floor(Math.random()*sayings.length)];
            var url = "http://translate.google.com/translate_tts?ie=UTF-8&tl=en&q="+encodeURIComponent(text);
            var audio = new Audio(url);
            audio.controls = true;
            var chargeLi = $('<li class="any-player"></li>');
            chargeLi.html(audio.outerHTML);
            $('#sayings').prepend(chargeLi);
            $(".any-player audio")[0].play();
            chargeLi = $('<li class="play-anything"></li>');
            $(chargeLi).text("Spoke: "+text);
            $('#sayings').prepend(chargeLi);
            setInterval(change_image, 250);

            console.log(""+text);
        });                

        socket.on('refresh', function (data) {
            location.reload();
        });

        function change_image() {
            var url = $('#croissant').attr("src");
            if (url == 'images/croissant-no-talk.png') {
                $('#croissant').attr("src","images/croissant-talk.png");
            } else {
                $('#croissant').attr("src","images/croissant-no-talk.png");
            }
        }

    </script>
</head>

<body>
    <br><br>
    <center><img src="images/croissant-no-talk.png" id="croissant"></center>
    <ul id="sayings"></ul>
</body>

</html>
